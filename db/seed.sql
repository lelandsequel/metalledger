-- MetalLedger v0 — Scrap Metal Synthetic Seed Data
-- 30+ rows of dealer prices spanning ~6 weeks (2024-01-02 to 2024-02-09)
-- Dealers: Houston Metals Inc (77001), Gulf Coast Scrap (77002), Lone Star Recycling (77003)
--
-- Price ranges (USD/lb unless noted):
--   HMS1:         ~$0.090-0.110/lb (~$180-220/ton)
--   HMS2:         ~$0.080-0.098/lb (~$160-195/ton)
--   SHRED:        ~$0.085-0.105/lb (~$170-210/ton)
--   CAST:         ~$0.060-0.080/lb (~$120-160/ton)
--   CU_BARE:      ~$3.50-4.20/lb
--   CU_1:         ~$3.20-3.90/lb
--   CU_2:         ~$2.80-3.40/lb
--   AL_CAST:      ~$0.35-0.55/lb
--   AL_EXTRUSION: ~$0.45-0.65/lb
--   BRASS:        ~$1.50-1.90/lb
--   SS_304:       ~$0.45-0.75/lb
--   LEAD:         ~$0.35-0.55/lb
--   ZORBA:        ~$0.55-0.80/lb

-- ============================================================
-- dealer_001 — Houston Metals Inc (ZIP 77001)
-- ============================================================

INSERT INTO prices_raw (source, metal, venue, price_ts, value, currency, source_id, dealer_id, location_zip, price_per_lb, price_per_ton, unit) VALUES
-- Ferrous
('seed', 'HMS1',  'DEALER:dealer_001:77001', '2024-01-02 20:00:00+00', 0.1005, 'USD', 'seed-d001-hms1-001', '00000000-0001-0000-0000-000000000001', '77001', 0.1005, 201.00, 'lb'),
('seed', 'HMS2',  'DEALER:dealer_001:77001', '2024-01-02 20:00:00+00', 0.0880, 'USD', 'seed-d001-hms2-001', '00000000-0001-0000-0000-000000000001', '77001', 0.0880, 176.00, 'lb'),
('seed', 'SHRED', 'DEALER:dealer_001:77001', '2024-01-02 20:00:00+00', 0.0950, 'USD', 'seed-d001-shred-001','00000000-0001-0000-0000-000000000001', '77001', 0.0950, 190.00, 'lb'),
('seed', 'CAST',  'DEALER:dealer_001:77001', '2024-01-02 20:00:00+00', 0.0710, 'USD', 'seed-d001-cast-001', '00000000-0001-0000-0000-000000000001', '77001', 0.0710, 142.00, 'lb'),
-- Non-ferrous
('seed', 'CU_BARE',     'DEALER:dealer_001:77001', '2024-01-02 20:00:00+00', 3.85, 'USD', 'seed-d001-cubare-001', '00000000-0001-0000-0000-000000000001', '77001', 3.85, 7700.00, 'lb'),
('seed', 'CU_1',        'DEALER:dealer_001:77001', '2024-01-02 20:00:00+00', 3.55, 'USD', 'seed-d001-cu1-001',   '00000000-0001-0000-0000-000000000001', '77001', 3.55, 7100.00, 'lb'),
('seed', 'CU_2',        'DEALER:dealer_001:77001', '2024-01-02 20:00:00+00', 3.10, 'USD', 'seed-d001-cu2-001',   '00000000-0001-0000-0000-000000000001', '77001', 3.10, 6200.00, 'lb'),
('seed', 'AL_CAST',     'DEALER:dealer_001:77001', '2024-01-02 20:00:00+00', 0.42, 'USD', 'seed-d001-alcast-001','00000000-0001-0000-0000-000000000001', '77001', 0.42,  840.00, 'lb'),
('seed', 'AL_EXTRUSION','DEALER:dealer_001:77001', '2024-01-02 20:00:00+00', 0.53, 'USD', 'seed-d001-alex-001',  '00000000-0001-0000-0000-000000000001', '77001', 0.53, 1060.00, 'lb'),
('seed', 'BRASS',       'DEALER:dealer_001:77001', '2024-01-02 20:00:00+00', 1.65, 'USD', 'seed-d001-brass-001', '00000000-0001-0000-0000-000000000001', '77001', 1.65, 3300.00, 'lb'),
('seed', 'SS_304',      'DEALER:dealer_001:77001', '2024-01-02 20:00:00+00', 0.58, 'USD', 'seed-d001-ss304-001', '00000000-0001-0000-0000-000000000001', '77001', 0.58, 1160.00, 'lb'),
('seed', 'LEAD',        'DEALER:dealer_001:77001', '2024-01-02 20:00:00+00', 0.42, 'USD', 'seed-d001-lead-001',  '00000000-0001-0000-0000-000000000001', '77001', 0.42,  840.00, 'lb'),
('seed', 'ZORBA',       'DEALER:dealer_001:77001', '2024-01-02 20:00:00+00', 0.65, 'USD', 'seed-d001-zorba-001', '00000000-0001-0000-0000-000000000001', '77001', 0.65, 1300.00, 'lb'),

-- Week 2 prices (slight variation)
('seed', 'HMS1',  'DEALER:dealer_001:77001', '2024-01-09 20:00:00+00', 0.1020, 'USD', 'seed-d001-hms1-002', '00000000-0001-0000-0000-000000000001', '77001', 0.1020, 204.00, 'lb'),
('seed', 'HMS2',  'DEALER:dealer_001:77001', '2024-01-09 20:00:00+00', 0.0895, 'USD', 'seed-d001-hms2-002', '00000000-0001-0000-0000-000000000001', '77001', 0.0895, 179.00, 'lb'),
('seed', 'CU_BARE','DEALER:dealer_001:77001','2024-01-09 20:00:00+00', 3.90, 'USD', 'seed-d001-cubare-002','00000000-0001-0000-0000-000000000001', '77001', 3.90, 7800.00, 'lb'),
('seed', 'AL_CAST','DEALER:dealer_001:77001','2024-01-09 20:00:00+00', 0.43, 'USD', 'seed-d001-alcast-002','00000000-0001-0000-0000-000000000001', '77001', 0.43, 860.00,  'lb'),
('seed', 'BRASS',  'DEALER:dealer_001:77001','2024-01-09 20:00:00+00', 1.67, 'USD', 'seed-d001-brass-002', '00000000-0001-0000-0000-000000000001', '77001', 1.67, 3340.00, 'lb'),

-- Week 4 prices
('seed', 'HMS1',   'DEALER:dealer_001:77001', '2024-01-22 20:00:00+00', 0.0990, 'USD', 'seed-d001-hms1-003', '00000000-0001-0000-0000-000000000001', '77001', 0.0990, 198.00, 'lb'),
('seed', 'CU_BARE','DEALER:dealer_001:77001', '2024-01-22 20:00:00+00', 3.88, 'USD', 'seed-d001-cubare-003','00000000-0001-0000-0000-000000000001', '77001', 3.88, 7760.00, 'lb'),
('seed', 'CU_1',   'DEALER:dealer_001:77001', '2024-01-22 20:00:00+00', 3.58, 'USD', 'seed-d001-cu1-002',   '00000000-0001-0000-0000-000000000001', '77001', 3.58, 7160.00, 'lb'),
('seed', 'ZORBA',  'DEALER:dealer_001:77001', '2024-01-22 20:00:00+00', 0.67, 'USD', 'seed-d001-zorba-002', '00000000-0001-0000-0000-000000000001', '77001', 0.67, 1340.00, 'lb'),

-- ============================================================
-- dealer_002 — Gulf Coast Scrap (ZIP 77002)
-- ============================================================
('seed', 'HMS1',  'DEALER:dealer_002:77002', '2024-01-02 20:00:00+00', 0.0980, 'USD', 'seed-d002-hms1-001', '00000000-0002-0000-0000-000000000002', '77002', 0.0980, 196.00, 'lb'),
('seed', 'HMS2',  'DEALER:dealer_002:77002', '2024-01-02 20:00:00+00', 0.0860, 'USD', 'seed-d002-hms2-001', '00000000-0002-0000-0000-000000000002', '77002', 0.0860, 172.00, 'lb'),
('seed', 'SHRED', 'DEALER:dealer_002:77002', '2024-01-02 20:00:00+00', 0.0930, 'USD', 'seed-d002-shred-001','00000000-0002-0000-0000-000000000002', '77002', 0.0930, 186.00, 'lb'),
('seed', 'CAST',  'DEALER:dealer_002:77002', '2024-01-02 20:00:00+00', 0.0690, 'USD', 'seed-d002-cast-001', '00000000-0002-0000-0000-000000000002', '77002', 0.0690, 138.00, 'lb'),
('seed', 'CU_BARE',     'DEALER:dealer_002:77002', '2024-01-02 20:00:00+00', 3.78, 'USD', 'seed-d002-cubare-001','00000000-0002-0000-0000-000000000002', '77002', 3.78, 7560.00, 'lb'),
('seed', 'CU_1',        'DEALER:dealer_002:77002', '2024-01-02 20:00:00+00', 3.48, 'USD', 'seed-d002-cu1-001',  '00000000-0002-0000-0000-000000000002', '77002', 3.48, 6960.00, 'lb'),
('seed', 'CU_2',        'DEALER:dealer_002:77002', '2024-01-02 20:00:00+00', 3.05, 'USD', 'seed-d002-cu2-001',  '00000000-0002-0000-0000-000000000002', '77002', 3.05, 6100.00, 'lb'),
('seed', 'AL_CAST',     'DEALER:dealer_002:77002', '2024-01-02 20:00:00+00', 0.40, 'USD', 'seed-d002-alcast-001','00000000-0002-0000-0000-000000000002', '77002', 0.40, 800.00, 'lb'),
('seed', 'AL_EXTRUSION','DEALER:dealer_002:77002', '2024-01-02 20:00:00+00', 0.50, 'USD', 'seed-d002-alex-001', '00000000-0002-0000-0000-000000000002', '77002', 0.50, 1000.00, 'lb'),
('seed', 'BRASS',       'DEALER:dealer_002:77002', '2024-01-02 20:00:00+00', 1.60, 'USD', 'seed-d002-brass-001','00000000-0002-0000-0000-000000000002', '77002', 1.60, 3200.00, 'lb'),
('seed', 'SS_304',      'DEALER:dealer_002:77002', '2024-01-02 20:00:00+00', 0.55, 'USD', 'seed-d002-ss304-001','00000000-0002-0000-0000-000000000002', '77002', 0.55, 1100.00, 'lb'),
('seed', 'LEAD',        'DEALER:dealer_002:77002', '2024-01-02 20:00:00+00', 0.40, 'USD', 'seed-d002-lead-001', '00000000-0002-0000-0000-000000000002', '77002', 0.40, 800.00, 'lb'),
('seed', 'ZORBA',       'DEALER:dealer_002:77002', '2024-01-02 20:00:00+00', 0.63, 'USD', 'seed-d002-zorba-001','00000000-0002-0000-0000-000000000002', '77002', 0.63, 1260.00, 'lb'),

-- Week 2
('seed', 'HMS1',   'DEALER:dealer_002:77002', '2024-01-09 20:00:00+00', 0.0995, 'USD', 'seed-d002-hms1-002',  '00000000-0002-0000-0000-000000000002', '77002', 0.0995, 199.00, 'lb'),
('seed', 'CU_BARE','DEALER:dealer_002:77002', '2024-01-09 20:00:00+00', 3.82, 'USD', 'seed-d002-cubare-002', '00000000-0002-0000-0000-000000000002', '77002', 3.82, 7640.00, 'lb'),
('seed', 'BRASS',  'DEALER:dealer_002:77002', '2024-01-09 20:00:00+00', 1.62, 'USD', 'seed-d002-brass-002',  '00000000-0002-0000-0000-000000000002', '77002', 1.62, 3240.00, 'lb'),

-- ============================================================
-- dealer_003 — Lone Star Recycling (ZIP 77003)
-- ============================================================
('seed', 'HMS1',  'DEALER:dealer_003:77003', '2024-01-02 20:00:00+00', 0.1015, 'USD', 'seed-d003-hms1-001', '00000000-0003-0000-0000-000000000003', '77003', 0.1015, 203.00, 'lb'),
('seed', 'HMS2',  'DEALER:dealer_003:77003', '2024-01-02 20:00:00+00', 0.0900, 'USD', 'seed-d003-hms2-001', '00000000-0003-0000-0000-000000000003', '77003', 0.0900, 180.00, 'lb'),
('seed', 'SHRED', 'DEALER:dealer_003:77003', '2024-01-02 20:00:00+00', 0.0965, 'USD', 'seed-d003-shred-001','00000000-0003-0000-0000-000000000003', '77003', 0.0965, 193.00, 'lb'),
('seed', 'CAST',  'DEALER:dealer_003:77003', '2024-01-02 20:00:00+00', 0.0725, 'USD', 'seed-d003-cast-001', '00000000-0003-0000-0000-000000000003', '77003', 0.0725, 145.00, 'lb'),
('seed', 'CU_BARE',     'DEALER:dealer_003:77003', '2024-01-02 20:00:00+00', 3.92, 'USD', 'seed-d003-cubare-001','00000000-0003-0000-0000-000000000003', '77003', 3.92, 7840.00, 'lb'),
('seed', 'CU_1',        'DEALER:dealer_003:77003', '2024-01-02 20:00:00+00', 3.62, 'USD', 'seed-d003-cu1-001',  '00000000-0003-0000-0000-000000000003', '77003', 3.62, 7240.00, 'lb'),
('seed', 'CU_2',        'DEALER:dealer_003:77003', '2024-01-02 20:00:00+00', 3.18, 'USD', 'seed-d003-cu2-001',  '00000000-0003-0000-0000-000000000003', '77003', 3.18, 6360.00, 'lb'),
('seed', 'AL_CAST',     'DEALER:dealer_003:77003', '2024-01-02 20:00:00+00', 0.44, 'USD', 'seed-d003-alcast-001','00000000-0003-0000-0000-000000000003', '77003', 0.44, 880.00, 'lb'),
('seed', 'AL_EXTRUSION','DEALER:dealer_003:77003', '2024-01-02 20:00:00+00', 0.56, 'USD', 'seed-d003-alex-001', '00000000-0003-0000-0000-000000000003', '77003', 0.56, 1120.00, 'lb'),
('seed', 'BRASS',       'DEALER:dealer_003:77003', '2024-01-02 20:00:00+00', 1.72, 'USD', 'seed-d003-brass-001','00000000-0003-0000-0000-000000000003', '77003', 1.72, 3440.00, 'lb'),
('seed', 'SS_304',      'DEALER:dealer_003:77003', '2024-01-02 20:00:00+00', 0.61, 'USD', 'seed-d003-ss304-001','00000000-0003-0000-0000-000000000003', '77003', 0.61, 1220.00, 'lb'),
('seed', 'LEAD',        'DEALER:dealer_003:77003', '2024-01-02 20:00:00+00', 0.44, 'USD', 'seed-d003-lead-001', '00000000-0003-0000-0000-000000000003', '77003', 0.44, 880.00, 'lb'),
('seed', 'ZORBA',       'DEALER:dealer_003:77003', '2024-01-02 20:00:00+00', 0.68, 'USD', 'seed-d003-zorba-001','00000000-0003-0000-0000-000000000003', '77003', 0.68, 1360.00, 'lb'),

-- Week 3 for dealer_003
('seed', 'HMS1',   'DEALER:dealer_003:77003', '2024-01-16 20:00:00+00', 0.1025, 'USD', 'seed-d003-hms1-002', '00000000-0003-0000-0000-000000000003', '77003', 0.1025, 205.00, 'lb'),
('seed', 'CU_BARE','DEALER:dealer_003:77003', '2024-01-16 20:00:00+00', 3.95, 'USD', 'seed-d003-cubare-002','00000000-0003-0000-0000-000000000003', '77003', 3.95, 7900.00, 'lb'),
('seed', 'CU_1',   'DEALER:dealer_003:77003', '2024-01-16 20:00:00+00', 3.65, 'USD', 'seed-d003-cu1-002',   '00000000-0003-0000-0000-000000000003', '77003', 3.65, 7300.00, 'lb'),
('seed', 'ZORBA',  'DEALER:dealer_003:77003', '2024-01-16 20:00:00+00', 0.70, 'USD', 'seed-d003-zorba-002', '00000000-0003-0000-0000-000000000003', '77003', 0.70, 1400.00, 'lb'),
('seed', 'BRASS',  'DEALER:dealer_003:77003', '2024-01-16 20:00:00+00', 1.74, 'USD', 'seed-d003-brass-002', '00000000-0003-0000-0000-000000000003', '77003', 1.74, 3480.00, 'lb'),
('seed', 'SS_304', 'DEALER:dealer_003:77003', '2024-01-16 20:00:00+00', 0.62, 'USD', 'seed-d003-ss304-002', '00000000-0003-0000-0000-000000000003', '77003', 0.62, 1240.00, 'lb');

-- ============================================================
-- Promote seed data to canonical (per metal — use highest dealer price)
-- ============================================================
INSERT INTO prices_canonical (metal, price_ts, value, currency, source, raw_id)
SELECT DISTINCT ON (metal, price_ts)
    metal, price_ts, value, currency, source, id
FROM prices_raw
WHERE source = 'seed'
ORDER BY metal, price_ts, value DESC
ON CONFLICT (metal, price_ts) DO NOTHING;
